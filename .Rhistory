oldpar <- par(mfrow = c(2, 5))
boxplot(HorizonTimePred[[i]]$Risk1$Bias, main =
paste0("Bias for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$RBias, main =
paste0("Relative Bias for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$RBias, main =
paste0("Relative Bias for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$Bias, main =
paste0("Relative Bias for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$RBias, main =
paste0("Relative Bias for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$RBias)
i = 1
boxplot(HorizonTimePred[[i]]$Risk1$RBias)
boxplot(HorizonTimePred[[i]]$Risk1$RBias, x = 0)
boxplot(HorizonTimePred[[i]]$Risk1$RBias)
boxplot(HorizonTimePred[[i]]$Risk1$RBias)
HorizonTimePred[[i]]$Risk1$RBias
HorizonTimePred <- GetBiasCP_DP(sim = 500, u = seq(4.5, 6, by = 0.5),
P1us = P1us, P2us = P2us, ParaMatrixRaw = a$ParaMatrixRaw)
HorizonTimePred[[i]]$Risk1$Rbias
oldpar <- par(mfrow = c(2, 5))
for (i in 1:length(HorizonTimePred)) {
boxplot(HorizonTimePred[[i]]$Risk1$Bias, main =
paste0("Bias for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$Rbias, main =
paste0("Relative Bias for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$SE, main =
paste0("SE for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk1$MSE, main =
paste0("MSE for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk1$CP, main =
paste0("CP for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0.95, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Bias, main =
paste0("Bias for risk 2\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Rbias, main =
paste0("Relative Bias for risk 2\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$SE, main =
paste0("SE for risk 2\nlandmark time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk2$MSE, main =
paste0("MSE for risk 2\nlandmark time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk2$CP, main =
paste0("CP for risk 2\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0.95, b = 0)
}
source("~/Desktop/GSR CODES/2022/2022 summer/Accord_DP/GetBiasCP_DP.R")
source("~/Desktop/GSR CODES/2022/2022 summer/Accord_DP/GetBiasCP_DP.R")
HorizonTimePred <- GetBiasCP_DP(sim = 500, u = seq(4.5, 6, by = 0.5),
P1us = P1us, P2us = P2us, ParaMatrixRaw = a$ParaMatrixRaw)
oldpar <- par(mfrow = c(2, 5))
for (i in 1:length(HorizonTimePred)) {
boxplot(HorizonTimePred[[i]]$Risk1$Bias, main =
paste0("Bias for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$Rbias, main =
paste0("Relative Bias (%) for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$SE, main =
paste0("SE for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk1$MSE, main =
paste0("MSE for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk1$CP, main =
paste0("CP for risk 1\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0.95, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Bias, main =
paste0("Bias for risk 2\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Rbias, main =
paste0("Relative Bias (%) for risk 2\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$SE, main =
paste0("SE for risk 2\nlandmark time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk2$MSE, main =
paste0("MSE for risk 2\nlandmark time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk2$CP, main =
paste0("CP for risk 2\nlandmark time:", names(HorizonTimePred)[i]))
abline(a = 0.95, b = 0)
}
oldpar <- par(mfrow = c(2, 5))
for (i in 1:length(HorizonTimePred)) {
boxplot(HorizonTimePred[[i]]$Risk1$Bias, main =
paste0("Bias for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$Rbias, main =
paste0("Relative Bias (%) for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$SE, main =
paste0("SE for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk1$MSE, main =
paste0("MSE for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk1$CP, main =
paste0("CP for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0.95, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Bias, main =
paste0("Bias for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Rbias, main =
paste0("Relative Bias (%) for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$SE, main =
paste0("SE for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk2$MSE, main =
paste0("MSE for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk2$CP, main =
paste0("CP for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0.95, b = 0)
}
devtools::load_all()
save.image("~/Desktop/test111.RData")
devtools::load_all()
time1 <- proc.time()
a <- simfitRI_DP(sim = 500, Nv = 500, Nt = 1000, seed = 100, increment = 0.5, CL = 4, CU = 8,
u = seq(4.5, 6, by = 0.5), quadpoint = 15, ncores = 11, M = 100)
time2 <- proc.time()
time2 - time1
save(a, file = "~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim500Nt1000Nq15M100.Rdata")
time1 <- proc.time()
a <- simfitRI_DP(sim = 500, Nv = 500, Nt = 1000, seed = 100, increment = 0.5, CL = 4, CU = 8,
u = seq(4.5, 6, by = 0.5), quadpoint = 15, ncores = 11, M = 100)
time2 <- proc.time()
time2 - time1
save(a, file = "~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim500Nt1000Nq15M100.Rdata")
130070/3600/24
## landmark time: 4.5
## future time for prediction: 5, 5.5, 6
source("~/Desktop/GSR CODES/2022/2022 summer/Accord_DP/GetBiasCP_DP.R")
HorizonTimePred <- GetBiasCP_DP(sim = 500, u = seq(4.5, 6, by = 0.5),
P1us = P1us, P2us = P2us, ParaMatrixRaw = a$ParaMatrixRaw)
P1us <- a$TrueP1ik
P2us <- a$TrueP2ik
View(P1us)
HorizonTimePred <- GetBiasCP_DP(sim = 500, u = seq(4.5, 6, by = 0.5),
P1us = P1us, P2us = P2us, ParaMatrixRaw = a$ParaMatrixRaw)
oldpar <- par(mfrow = c(2, 5))
for (i in 1:length(HorizonTimePred)) {
boxplot(HorizonTimePred[[i]]$Risk1$Bias, main =
paste0("Bias for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$Rbias, main =
paste0("Relative Bias (%) for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$SE, main =
paste0("SE for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk1$MSE, main =
paste0("MSE for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk1$CP, main =
paste0("CP for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0.95, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Bias, main =
paste0("Bias for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Rbias, main =
paste0("Relative Bias (%) for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$SE, main =
paste0("SE for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk2$MSE, main =
paste0("MSE for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk2$CP, main =
paste0("CP for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0.95, b = 0)
}
HorizonTimePred$`6`$Risk1$Bias
HorizonTimePred$`6`$Risk1$CP
devtools::load_all()
devtools::document()
a1 <- a
load("~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim500Nv500Nq10M100.Rdata")
P1us <- a$TrueP1ik
P2us <- a$TrueP2ik
HorizonTimePred_10 <- GetBiasCP_DP(sim = 500, u = seq(4.5, 6, by = 0.5),
P1us = P1us, P2us = P2us, ParaMatrixRaw = a$ParaMatrixRaw)
HorizonTimePred_10$`6`$Risk1$Bias
HorizonTimePred_10$`6`$Risk1$CP
HorizonTimePred$`6`$Risk1$CP
data(cdata)
data("ydata")
fit <- JMMLSM(cdata = cdata, ydata = ydata,
long.formula = Y ~ Z1 + Z2 + Z3 + time,
surv.formula = Surv(survtime, cmprsk) ~ var1 + var2 + var3,
variance.formula = ~ Z1 + Z2 + Z3 + time, maxiter = 1000, epsilon = 1e-04,
quadpoint = 15, random = ~ 1|ID, print.para = TRUE)
devtools::load_all()
fit2 <- JMMLSM(cdata = cdata, ydata = ydata,
long.formula = Y ~ Z1 + Z2 + Z3 + time,
surv.formula = Surv(survtime, cmprsk) ~ var1 + var2 + var3,
variance.formula = ~ Z1 + Z2 + Z3 + time, maxiter = 1000, epsilon = 1e-04,
quadpoint = 15, random = ~ 1|ID, print.para = TRUE)
fit
fit2
time1 <- proc.time()
a <- simfitRI_DP(sim = 50, Nv = 100, Nt = 1000, seed = 100, increment = 0.5, CL = 4, CU = 8,
u = c(4.5, 5.5, 6), quadpoint = 15, ncores = 11, M = 500)
time2 <- proc.time()
time2 - time1
save(a, file = "~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim50Nt1000Nq15M500.Rdata")
devtools::load_all()
time1 <- proc.time()
a <- simfitRI_DP(sim = 50, Nv = 100, Nt = 1000, seed = 100, increment = 0.5, CL = 4, CU = 8,
u = c(4.5, 5.5, 6), quadpoint = 15, ncores = 11, M = 500)
time2 <- proc.time()
time2 - time1
save(a, file = "~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim50Nt1000Nq15M500.Rdata")
time1 <- proc.time()
a <- simfitRI_DP(sim = 50, Nv = 100, Nt = 2000, seed = 100, increment = 0.5, CL = 4, CU = 8,
u = c(4.5, 5.5, 6), quadpoint = 15, ncores = 11, M = 500)
time2 <- proc.time()
time2 - time1
save(a, file = "~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim50Nt2000Nq15M500.Rdata")
load("~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim50Nt1000Nq15M500.Rdata")
load("~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim50Nt2000Nq15M500.Rdata")
data <- simJMdataRI(seed = 100, N =500, increment = 0.5)
ydata <- data$ydata
cdata <- data$cdata
data <- simJMdataRI(seed = 100, N =500, increment = 0.5, lambda2 = 0.1)
ydata <- data$ydata
cdata <- data$cdata
fit <- JMMLSM(cdata = cdata, ydata = ydata,
long.formula = Y ~ Z1 + Z2 + Z3 + time,
surv.formula = Surv(survtime, cmprsk) ~ var1 + var2 + var3,
variance.formula = ~ Z1 + Z2 + Z3 + time, maxiter = 1000, epsilon = 1e-04,
quadpoint = 10, random = ~ 1|ID, print.para = TRUE)
View(cdata)
cdata2 <- cdata[cdata$ID == 265, ]
ydata2 <- ydata[ydata$ID == 265, ]
survfit <- survfit2JMMLSM(fit, seed = 100, ynewdata = ydata2, cnewdata = cdata2,
u = c(4, 6), M = 100, simulate = TRUE, quadpoint = 10)
survfit <- survfit2JMMLSM(fit, seed = 100, ynewdata = ydata2, cnewdata = cdata2,
u = seq(4, 6, by = 1), M = 100, simulate = TRUE, quadpoint = 10)
View(cdata2)
cdata2 <- cdata[cdata$ID %in% c(265, 199), ]
ydata2 <- ydata[ydata$ID %in% c(265, 199), ]
survfit <- survfit2JMMLSM(fit, seed = 100, ynewdata = ydata2, cnewdata = cdata2,
u = seq(4, 6, by = 1), M = 100, simulate = TRUE, quadpoint = 10)
devtools::load_all()
survfit <- survfit2JMMLSM(fit, seed = 100, ynewdata = ydata2, cnewdata = cdata2,
u = seq(4, 6, by = 1), M = 100, simulate = TRUE, quadpoint = 10)
devtools::load_all()
survfit <- survfit2JMMLSM(fit, seed = 100, ynewdata = ydata2, cnewdata = cdata2,
u = seq(4, 6, by = 1), M = 100, simulate = TRUE, quadpoint = 10)
vcov(fit)
fit$beta
devtools::load_all()
vcov(fit)
devtools::load_all()
vcov(fit)
devtools::load_all()
vcov(fit)
devtools::load_all()
time1 <- proc.time()
a <- simfitRI_DP(sim = 50, Nv = 100, Nt = 1000, seed = 100, increment = 0.5, CL = 4, CU = 8,
u = c(4.5, 5.5, 6), quadpoint = 15, ncores = 11, M = 500)
time2 <- proc.time()
time2 - time1
save(a, file = "~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim50Nt1000Nq15M500.Rdata")
HorizonTimePred_10 <- GetBiasCP_DP(sim = 50, u = seq(4.5, 6, by = 0.5),
P1us = a$TrueP1ik, P2us = a$TrueP2ik, ParaMatrixRaw = a$ParaMatrixRaw)
## landmark time: 4.5
## future time for prediction: 5, 5.5, 6
source("~/Desktop/GSR CODES/2022/2022 summer/Accord_DP/GetBiasCP_DP.R")
HorizonTimePred <- GetBiasCP_DP(sim = 50, u = c(4.5, 5.5, 6),
P1us = a$TrueP1ik, P2us = a$TrueP2ik, ParaMatrixRaw = a$ParaMatrixRaw)
oldpar <- par(mfrow = c(2, 5))
for (i in 1:length(HorizonTimePred)) {
boxplot(HorizonTimePred[[i]]$Risk1$Bias, main =
paste0("Bias for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$Rbias, main =
paste0("Relative Bias (%) for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$SE, main =
paste0("SE for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk1$MSE, main =
paste0("MSE for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk1$CP, main =
paste0("CP for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0.95, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Bias, main =
paste0("Bias for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Rbias, main =
paste0("Relative Bias (%) for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$SE, main =
paste0("SE for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk2$MSE, main =
paste0("MSE for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk2$CP, main =
paste0("CP for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0.95, b = 0)
}
{
boxplot(HorizonTimePred[[i]]$Risk1$Bias, main =
paste0("Bias for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$Rbias, main =
paste0("Relative Bias (%) for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$SE, main =
paste0("SE for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk1$MSE, main =
paste0("MSE for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk1$CP, main =
paste0("CP for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0.95, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Bias, main =
paste0("Bias for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Rbias, main =
paste0("Relative Bias (%) for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$SE, main =
paste0("SE for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk2$MSE, main =
paste0("MSE for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk2$CP, main =
paste0("CP for risk 2\nHorizon time:", names(HorizonTimePred)[i]), outline = FALSE)
abline(a = 0.95, b = 0)
}
{
boxplot(HorizonTimePred[[i]]$Risk1$Bias, main =
paste0("Bias for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$Rbias, main =
paste0("Relative Bias (%) for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$SE, main =
paste0("SE for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk1$MSE, main =
paste0("MSE for risk 1\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk1$CP, main =
paste0("CP for risk 1\nHorizon time:", names(HorizonTimePred)[i]), outline = FALSE)
abline(a = 0.95, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Bias, main =
paste0("Bias for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Rbias, main =
paste0("Relative Bias (%) for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$SE, main =
paste0("SE for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk2$MSE, main =
paste0("MSE for risk 2\nHorizon time:", names(HorizonTimePred)[i]))
boxplot(HorizonTimePred[[i]]$Risk2$CP, main =
paste0("CP for risk 2\nHorizon time:", names(HorizonTimePred)[i]), outline = FALSE)
abline(a = 0.95, b = 0)
}
devtools::load_all()
time1 <- proc.time()
a <- simfitRI_DP(sim = 500, Nv = 500, Nt = 500, seed = 100, increment = 0.5, CL = 2, CU = 10,
u = seq(3, 7, by = 2), quadpoint = 10, ncores = 11, M = 500)
time2 <- proc.time()
time2 - time1
save(a, file = "~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim500Nt500Nq10M500.Rdata")
time1 <- proc.time()
a <- simfitRI_DP(sim = 500, Nv = 500, Nt = 500, seed = 100, increment = 0.5, CL = 2, CU = 10,
u = seq(3, 7, by = 2), quadpoint = 15, ncores = 11, M = 500)
time2 <- proc.time()
time2 - time1
save(a, file = "~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim500Nt500Nq15M500.Rdata")
a$TrueP1ik[1:5, ]
HorizonTimePred <- GetBiasCP_DP(sim = 500, u = c(3, 5, 7),
P1us = a$TrueP1ik, P2us = a$TrueP2ik, ParaMatrixRaw = a$ParaMatrixRaw)
## landmark time: 4.5
## future time for prediction: 5, 5.5, 6
source("~/Desktop/GSR CODES/2022/2022 summer/Accord_DP/GetBiasCP_DP.R")
HorizonTimePred <- GetBiasCP_DP(sim = 500, u = c(3, 5, 7),
P1us = a$TrueP1ik, P2us = a$TrueP2ik, ParaMatrixRaw = a$ParaMatrixRaw)
oldpar <- par(mfrow = c(2, 5))
for (i in 1:length(HorizonTimePred)) {
boxplot(HorizonTimePred[[i]]$Risk1$Bias, main =
paste0("Bias for risk 1\nHorizon time:", names(HorizonTimePred)[i]),
outline = FALSE)
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$Rbias, main =
paste0("Relative Bias (%) for risk 1\nHorizon time:", names(HorizonTimePred)[i]),
outline = FALSE)
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk1$SE, main =
paste0("SE for risk 1\nHorizon time:", names(HorizonTimePred)[i]),
outline = FALSE)
boxplot(HorizonTimePred[[i]]$Risk1$MSE, main =
paste0("MSE for risk 1\nHorizon time:", names(HorizonTimePred)[i]),
outline = FALSE)
boxplot(HorizonTimePred[[i]]$Risk1$CP, main =
paste0("CP for risk 1\nHorizon time:", names(HorizonTimePred)[i]),
outline = FALSE)
abline(a = 0.95, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Bias, main =
paste0("Bias for risk 2\nHorizon time:", names(HorizonTimePred)[i]),
outline = FALSE)
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$Rbias, main =
paste0("Relative Bias (%) for risk 2\nHorizon time:", names(HorizonTimePred)[i]),
outline = FALSE)
abline(a = 0, b = 0)
boxplot(HorizonTimePred[[i]]$Risk2$SE, main =
paste0("SE for risk 2\nHorizon time:", names(HorizonTimePred)[i]),
outline = FALSE)
boxplot(HorizonTimePred[[i]]$Risk2$MSE, main =
paste0("MSE for risk 2\nHorizon time:", names(HorizonTimePred)[i]),
outline = FALSE)
boxplot(HorizonTimePred[[i]]$Risk2$CP, main =
paste0("CP for risk 2\nHorizon time:", names(HorizonTimePred)[i]),
outline = FALSE)
abline(a = 0.95, b = 0)
}
devtools::load_all()
ydata <- data$ydata
cdata <- data$cdata
fit <- JMMLSM(cdata = cdata, ydata = ydata,
long.formula = Y ~ Z1 + Z2 + Z3 + time,
surv.formula = Surv(survtime, cmprsk) ~ var1 + var2 + var3,
variance.formula = ~ Z1 + Z2 + Z3 + time, maxiter = 1000, epsilon = 1e-04,
quadpoint = 10, random = ~ 1|ID, print.para = TRUE)
a <- proc.time()
N200q15RI <- JMH::simfitRI(sim = 500, N = 200, lambda1 = 0.05, lambda2 = 0.1,
tau = c(0.5, 0.5, -0.2, 0.2, 0.05),
CL = 2, CU = 10, seed = 100, maxiter = 1000,
increment = 0.25, quadpoint = 15, ncores = 11)
b <- proc.time()
b - a
a <- proc.time()
N800q15RI <- JMH::simfitRI(sim = 500, N = 800, lambda1 = 0.05, lambda2 = 0.1,
tau = c(0.5, 0.5, -0.2, 0.2, 0.05),
CL = 2, CU = 10, seed = 100, maxiter = 1000,
increment = 0.25, quadpoint = 15, ncores = 11)
b <- proc.time()
b - a
save.image("~/Desktop/GSR CODES/2022/2022 summer/JMH_Sim/Table1&2.RData")
data <- simJMdataRI(seed = 100, N =500, increment = 0.5, lambda2 = 0.1)
ydata <- data$ydata
cdata <- data$cdata
data <- simJMdataRI(seed = 100, N =200, increment = 0.5, lambda2 = 0.1)
ydata <- data$ydata
cdata <- data$cdata
fit <- JMMLSM(cdata = cdata, ydata = ydata,
long.formula = Y ~ Z1 + Z2 + Z3 + time,
surv.formula = Surv(survtime, cmprsk) ~ var1 + var2 + var3,
variance.formula = ~ Z1 + Z2 + Z3 + time, maxiter = 1000, epsilon = 1e-04,
quadpoint = 10, random = ~ 1|ID, print.para = TRUE)
View(cdata)
cdata2 <- cdata[cdata$ID %in% c(98, 116), ]
ydata2 <- ydata[ydata$ID %in% c(98, 116), ]
survfit <- survfit2JMMLSM(fit, seed = 100, ynewdata = ydata2, cnewdata = cdata2,
u = seq(2.5, 4.5, by = 1), M = 20, simulate = TRUE, quadpoint = 10)
devtools::load_all()
survfit <- survfit2JMMLSM(fit, seed = 100, ynewdata = ydata2, cnewdata = cdata2,
u = seq(2.5, 4.5, by = 1), M = 20, simulate = TRUE, quadpoint = 10)
survfit
devtools::load_all()
survfit <- survfit2JMMLSM(fit, seed = 100, ynewdata = ydata2, cnewdata = cdata2,
u = seq(2.5, 4.5, by = 1), M = 20, simulate = TRUE, quadpoint = 10)
a <- c(1, 2, 3, 4, 5, 6)
a <- matrix(a, nrow = 2, ncol = 3)
a
a <- rbind(a, a)
a
a[1, ] <- NA
a
a <- a[complete.cases(a), ]
a
devtools::load_all()
time1 <- proc.time()
a <- simfitRI_DP(sim = 500, Nv = 500, Nt = 200, seed = 100, increment = 0.25, CL = 2, CU = 10,
u = seq(3, 7, by = 1), quadpoint = 15, ncores = 11, M = 500)
time2 <- proc.time()
time2 - time1
save(a, file = "~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim500Nt200Nq15M500.Rdata")
time1 <- proc.time()
a <- simfitRI_DP(sim = 500, Nv = 500, Nt = 200, seed = 100, increment = 0.5, CL = 2, CU = 10,
u = seq(3, 7, by = 1), quadpoint = 15, ncores = 11, M = 500)
time2 <- proc.time()
time2 - time1
save(a, file = "~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim500Nt200Nq15M500.Rdata")
devtools::load_all()
load("~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim500Nt200Nq15M500Nv500Incre0.25.Rdata")
a$ParaMatrixRaw[[2]]$pred1$`1`
a$ParaMatrixRaw[[2]]$pred1$`3`
source("~/Desktop/GSR CODES/2022/2022 summer/Accord_DP/GetBiasCP_DP.R")
HorizonTimePred <- GetBiasCP_DP(sim = 500, u = seq(3, 7, by = 1),
P1us = a$TrueP1ik, P2us = a$TrueP2ik, ParaMatrixRaw = a$ParaMatrixRaw)
head(HorizonTimePred$`4`$Risk1$Bias)
head(HorizonTimePred$`4`$Risk1$CP)
head(HorizonTimePred$`4`$Risk1$CP, 20)
head(HorizonTimePred$`4`$Risk1$CP, 30)
head(HorizonTimePred$`4`$Risk1$SE, 30)
devtools::load_all()
devtools::load_all()
data <- simJMdataRI(seed = 100, N =200, increment = 0.5, lambda2 = 0.1)
ydata <- data$ydata
cdata <- data$cdata
fit <- JMMLSM(cdata = cdata, ydata = ydata,
long.formula = Y ~ Z1 + Z2 + Z3 + time,
surv.formula = Surv(survtime, cmprsk) ~ var1 + var2 + var3,
variance.formula = ~ Z1 + Z2 + Z3 + time, maxiter = 1000, epsilon = 1e-04,
quadpoint = 10, random = ~ 1|ID, print.para = TRUE)
a$ParaMatrixRaw[[2]]$pred1$`1`
load("~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim500Nt200Nq15M500Incre0.25New.Rdata")
a$ParaMatrixRaw[[2]]$pred1$`1`
load("~/Desktop/GSR CODES/2022/2022 summer/JMH_DP/sim500Nt200Nq15M500Nv500Incre0.25.Rdata")
a$ParaMatrixRaw[[2]]$pred1$`1`
